import {REST} from './rest.js';
import {Project} from './model.js';

export const base = '/sap/zabapopentest';

class StartPage {
  renderList(list) {
    let result = "";
    for(let project of list) {
      result = result + 
        "<div>" + 
        "Name: " + project.NAME + "<br>" +
        "Package: " + project.DEVCLASS +
        "</div>"
    }
    if(list.length === 0) {
        alert("project list empty");
    }
    return result;
  }

  render() {
    return "StartPage " + REST.listProjects(this.renderList) + 
        "<br><a href=\"" + base + "/rest/swagger.html\">swagger</a>";
  }
}

class NotFoundPage {
  render() {
    return "NotFoundPage";
  }
}

// ----------------

function renderHeader() {
  return "header<hr>";
}

function renderFooter() {
  return "<hr>footer";
}

function runRouter() {
  if (!window.location.pathname.startsWith(base)) {
    throw "unknown url";
  }

  const path = window.location.pathname.substr(base.length);

  let page;

  if (path === "" || path === "/") {
    page = new StartPage();
  }

  if (!page) {
    page = new NotFoundPage();
  }

  document.getElementById("app").innerHTML = renderHeader() + page.render() + renderFooter();
}

runRouter();